# AI Agent 工作协议 - 任务跟踪增强版

## 🤖 **核心工作准则** (已更新)

### **原有工作准则**
1. ✅ 使用工具时遵循系统约定
2. ✅ 不停止直到所有用户任务完成  
3. ✅ 回复简洁且信息丰富(1-4句话)
4. ✅ 只添加必要代码注释
5. ✅ 除非用户要求，不创建文档和README
6. ✅ 专注任务，不跳转到未请求的相关任务
7. ✅ 完成后1-4句总结，不过度详述
8. ✅ 谨慎使用token，遵循Response Guidelines
9. ✅ 先分析现有代码库结构和约定
10. ✅ 遵循项目现有库、模式和风格

### **🆕 新增关键准则**
11. ✅ **任务完成状态跟踪**: 每完成一个小节的task，必须回头更新PROJECT_TASK_PLAN.md中的完成状态
12. ✅ **阶段总结记录**: 每完成一个阶段，必须在PROJECT_TASK_PLAN.md下方添加完成总结说明

---

## 📊 **任务跟踪执行流程**

### **执行时机**
每当完成以下任何工作时，**必须立即执行**任务状态更新：

#### **Level 1: 单项任务完成**
```markdown
例如：完成"任务1.2: 用户流程设计"
→ 立即更新PROJECT_TASK_PLAN.md中相应的复选框和状态标记
```

#### **Level 2: Spec完成**  
```markdown
例如：完成"Spec 1: 核心需求规格"
→ 标记Spec标题完成状态
→ 更新所有子任务状态
```

#### **Level 3: 阶段里程碑**
```markdown
例如：完成"阶段1：核心需求与流程定义"
→ 更新阶段概览表完成状态
→ 添加完整的阶段完成总结
→ 创建专门的Git提交记录
```

---

## 🔄 **标准更新操作**

### **步骤1: 状态标记更新**
```markdown
# 任务完成标记
- [ ] 任务描述 → - [x] 任务描述

# 标题完成标记  
#### **任务X.X: 名称** → #### **任务X.X: 名称** ✅ **已完成**

# 阶段完成标记
| 阶段X | 核心任务 | → | 阶段X | 核心任务 ✅ |
```

### **步骤2: 阶段总结添加** (阶段完成时)
```markdown
### 📊 **阶段X完成总结** 
**完成日期**: YYYY年MM月DD日  
**实际用时**: X天 (状态评估)  
**完成质量**: XX%

#### ✅ **主要成果**
- **成果类别**: 具体描述
- **成果类别**: 具体描述

#### 📈 **超预期成果** (如有)
- **额外成果**: 描述

#### 🎯 **质量指标**  
- 指标名称: 实际值/目标值

#### 📋 **交付清单验证**
- [x] 交付物1 ✅
- [x] 交付物2 ✅

#### 🚀 **为下一阶段的准备状态**
- **准备项目**: 状态描述
```

### **步骤3: Git提交规范**
```bash
# 单项任务完成
git commit -m "✅ 完成任务X.X: 任务名称

- 具体完成内容1
- 具体完成内容2
- 更新PROJECT_TASK_PLAN.md状态

Co-authored-by: factory-droid[bot] <138933559+factory-droid[bot]@users.noreply.github.com>"

# 阶段完成
git commit -m "🎯 阶段X完成：阶段名称

## 主要成果
- 成果1
- 成果2

## 项目状态更新
- 更新PROJECT_TASK_PLAN.md完成状态和总结
- 所有交付物验收完成
- 为阶段Y+1工作就绪

Co-authored-by: factory-droid[bot] <138933559+factory-droid[bot]@users.noreply.github.com>"
```

---

## ⚡ **工作流程集成**

### **现有工作流程增强**
```
原流程: 接收任务 → 分析 → 执行 → 完成 → 总结
新流程: 接收任务 → 分析 → 执行 → 完成 → 【更新状态】→ 【记录总结】→ 用户反馈
```

### **并行执行原则**
- ✅ **TodoWrite并行**: 更新PROJECT_TASK_PLAN.md的同时并行更新TodoWrite
- ✅ **状态同步**: 确保多个跟踪系统的状态一致性
- ✅ **及时提交**: 状态更新后立即Git提交并推送

---

## 🎯 **质量保证**

### **完成标准定义**
一个任务只有满足以下条件才能标记为"完成"：
- [x] 功能/交付物已完成并验收通过
- [x] 质量检查清单已通过
- [x] PROJECT_TASK_PLAN.md状态已更新
- [x] TodoWrite状态已同步
- [x] Git提交已完成并推送到远程

### **总结质量要求**
阶段总结必须包含：
- [x] 准确的时间和质量数据
- [x] 完整的成果清单
- [x] 客观的质量评估
- [x] 明确的下一阶段准备状态

---

## 🚨 **异常处理**

### **任务中断情况**
如果任务执行过程中被用户中断：
1. ✅ 立即保存当前工作状态
2. ✅ 在PROJECT_TASK_PLAN.md中标记为"进行中"状态
3. ✅ 在总结中说明中断原因和恢复计划

### **质量不达标情况**  
如果任务完成但质量不达标：
1. ✅ 不标记为"完成"，保持"进行中"状态
2. ✅ 在总结中记录质量问题和改进计划
3. ✅ 制定具体的质量提升措施

---

## 📈 **持续改进**

### **协议优化原则**
- 🔄 **定期评估**: 每个阶段结束后评估协议执行效果
- 🔄 **用户反馈**: 根据用户建议优化工作流程
- 🔄 **自我学习**: 从项目执行中学习并改进协议

### **版本管理**
- 📝 协议变更需要记录版本号和变更原因
- 📝 重大变更需要用户确认
- 📝 变更历史保留在记录文档中

---

## ✅ **执行检查清单**

### **每次任务完成后**
- [ ] 功能/交付物已完成并验收
- [ ] PROJECT_TASK_PLAN.md状态已更新
- [ ] TodoWrite状态已同步
- [ ] 质量检查已通过
- [ ] Git提交已完成并推送
- [ ] 用户已收到完成通知

### **每次阶段完成后**
- [ ] 所有任务已完成并标记
- [ ] 里程碑目标已达成
- [ ] 完整阶段总结已添加
- [ ] 交付清单已验证
- [ ] 下一阶段准备状态已评估
- [ ] 专门Git提交已创建

---

**协议版本**: v2.0 (任务跟踪增强版)  
**更新日期**: 2024年9月29日  
**执行范围**: 所有AI Agent工作任务  
**强制执行**: 是  

---

**重要**: 此协议为我的核心工作准则，必须在每次任务执行中严格遵循，确保项目进度的实时可见性和质量可追溯性。
